<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>GeoProx - Sign in</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      color-scheme: dark;
      --bg: #0b1724;
      --panel: #13263c;
      --panel-alt: #0f2237;
      --accent: #2b7cff;
      --accent-dim: #1c5fe6;
      --text: #e6f1ff;
      --muted: #96a8c0;
      --error: #ff8a8a;
      --success: #6ce1b1;
      --overlay-bg: rgba(5, 12, 21, 0.82);
      --modal-bg: #152b44;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #152d45 0%, #09121d 60%);
      font-family: "Segoe UI", system-ui, sans-serif;
      color: var(--text);
      padding: 32px 16px;
    }
    .layout {
      width: min(1200px, 100%);
      display: flex;
      gap: 28px;
      align-items: stretch;
      flex-wrap: wrap;
    }
    .panel {
      background: var(--panel);
      border-radius: 20px;
      padding: 28px;
      border: 1px solid rgba(255, 255, 255, 0.04);
      box-shadow: 0 18px 40px rgba(6, 18, 29, 0.35);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .left-panel { flex: 1 1 55%; }
    .right-panel { flex: 1 1 40%; max-width: 420px; }
    .logo {
      width: 88px;
    }
    .hero-header {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .hero-title {
      margin: 0;
      font-size: 1.8rem;
    }
    .hero-copy {
      margin: 0;
      color: var(--muted);
      font-size: 0.95rem;
      line-height: 1.5;
    }
    .promo-showcase {
      flex: 1;
      padding: 1.6rem 1.8rem;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: linear-gradient(135deg, rgba(43,124,255,0.25), rgba(17,59,99,0.85));
      display: flex;
      flex-direction: column;
      gap: 1.6rem;
      box-shadow: 0 14px 48px rgba(11, 23, 36, 0.55);
    }
    .promo-header h3 {
      margin: 0;
      font-size: 1.45rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    .promo-header p {
      margin: 0.65rem 0 0;
      color: rgba(230, 241, 255, 0.78);
      font-size: 0.95rem;
      line-height: 1.55;
    }
    .promo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
    }
    .promo-feature {
      background: rgba(6, 17, 27, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 14px;
      padding: 1rem 1.1rem;
    }
    .promo-feature h4 {
      margin: 0 0 0.4rem;
      font-size: 0.95rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .promo-feature p {
      margin: 0;
      color: rgba(230, 241, 255, 0.75);
      font-size: 0.85rem;
      line-height: 1.55;
    }
    .promo-metrics {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .promo-metric {
      flex: 1;
      min-width: 120px;
      padding: 0.9rem 1rem;
      background: rgba(0, 0, 0, 0.25);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .promo-metric strong {
      display: block;
      font-size: 1.2rem;
      color: #ffffff;
      margin-bottom: 0.25rem;
    }
    .promo-metric span {
      color: rgba(230, 241, 255, 0.72);
      font-size: 0.82rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }
    @media (max-width: 720px) {
      .promo-showcase {
        padding: 1.25rem 1.3rem;
      }
    }
    .cta-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }
    .cta {
      flex: 1;
      min-width: 180px;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }
    .cta.primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-dim));
      border: none;
      box-shadow: 0 10px 24px rgba(43, 124, 255, 0.25);
    }
    .cta.secondary:hover,
    .cta.primary:hover {
      transform: translateY(-1px);
    }
    .alert {
      padding: 12px 16px;
      border-radius: 12px;
      font-size: 0.9rem;
      border: 1px solid transparent;
    }
    .alert.error { background: rgba(255,90,90,0.14); border-color: rgba(255,138,138,0.35); color: var(--error); }
    .alert.success { background: rgba(62,201,145,0.14); border-color: rgba(62,201,145,0.35); color: var(--success); }

    .card-title {
      margin: 0 0 4px;
      font-size: 1.6rem;
      text-align: center;
    }
    .card-subtitle {
      margin: 0 0 24px;
      text-align: center;
      color: var(--muted);
      font-size: 0.95rem;
    }
    label {
      display: block;
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 6px;
    }
    input[type=text],
    input[type=password],
    input[type=email],
    input[type=tel],
    select,
    textarea {
      width: 100%;
      background: #0f1f31;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      color: var(--text);
      padding: 12px 14px;
      font-size: 1rem;
      margin-bottom: 16px;
    }
    textarea { min-height: 96px; resize: vertical; }
    .checkbox-row {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 20px;
      color: var(--muted);
      font-size: 0.82rem;
    }
    .checkbox-row input[type=checkbox] { margin-top: 2px; }
    .primary-btn {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg, var(--accent), var(--accent-dim));
      color: white;
      font-size: 1.05rem;
      font-weight: 600;
      cursor: pointer;
    }
    .footer {
      margin-top: 16px;
      text-align: center;
      font-size: 0.82rem;
      color: var(--muted);
    }
    a { color: var(--accent); text-decoration: none; }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: var(--overlay-bg);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 32px;
      z-index: 20;
    }
    .modal-overlay.open { display: flex; }
    .modal {
      background: var(--modal-bg);
      border-radius: 16px;
      width: min(720px, 100%);
      max-height: 90vh;
      overflow-y: auto;
      padding: 28px 32px;
      box-shadow: 0 20px 48px rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255,255,255,0.08);
    }
    .modal h2 { margin-top: 0; font-size: 1.35rem; }
    .modal p { font-size: 0.9rem; line-height: 1.55; color: var(--muted); margin: 0 0 12px; }
    .modal .actions { display:flex; gap:12px; justify-content:flex-end; margin-top:12px; }
    .modal button { padding:10px 16px; border:none; border-radius:8px; cursor:pointer; font-weight:600; }
    .modal .close-btn { background: rgba(255,255,255,0.08); color: var(--text); }
    .modal .submit-btn { background: var(--accent); color: #fff; }

    .dual-column {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }
    .dual-column > div { flex: 1 1 200px; }

    @media (max-width: 960px) {
      .layout { flex-direction: column; }
      .left-panel, .right-panel { max-width: none; }
      .promo-showcase { min-height: auto; }
    }
  </style>
</head>
<body data-open-modal="{{ open_modal or '' }}">
  <div class="layout">
    <section class="panel left-panel">
      <div class="hero-header">
        <img class="logo" src="/static/geoprox-logo.png" alt="GeoProx logo">
        <div>
          <h1 class="hero-title">GeoProx Intelligence</h1>
          <p class="hero-copy">Plan safer works with up-to-the-minute proximity intelligence and automated desktop risk assessments.</p>
        </div>
      </div>

      {% if signup_success %}
        <div class="alert success">{{ signup_success }}</div>
      {% endif %}
      {% if upgrade_success %}
        <div class="alert success">{{ upgrade_success }}</div>
      {% endif %}
      {% if signup_error %}
        <div class="alert error">{{ signup_error }}</div>
      {% endif %}
      {% if upgrade_error %}
        <div class="alert error">{{ upgrade_error }}</div>
      {% endif %}

      <div class="promo-showcase">
        <div class="promo-header">
          <h3>Hazard intelligence for every permit</h3>
          <p>GeoProx centralises your desktop assessments, field inspections, and sampling evidence so project teams can trust the data behind every dig. No more chasing email threads or dusty folders&mdash;everything you need is ready the moment you sign in.</p>
        </div>
        <div class="promo-grid">
          <div class="promo-feature">
            <h4>Instant desktop searches</h4>
            <p>Run point or polygon proximity checks against the latest utility, environmental, and historical hazard datasets in seconds.</p>
          </div>
          <div class="promo-feature">
            <h4>Site evidence that sticks</h4>
            <p>Capture field photos, lab results, and sign-offs straight into the permit record&mdash;backed by tamper-evident PDFs.</p>
          </div>
          <div class="promo-feature">
            <h4>Company-wide visibility</h4>
            <p>See every permit your organisation has produced, complete with named contributors and a full audit trail.</p>
          </div>
        </div>
        <div class="promo-metrics">
          <div class="promo-metric">
            <strong>5 min</strong>
            <span>average desktop decision time</span>
          </div>
          <div class="promo-metric">
            <strong>100&#43;</strong>
            <span>hazard layers harmonised</span>
          </div>
          <div class="promo-metric">
            <strong>24/7</strong>
            <span>secure access across devices</span>
          </div>
        </div>
      </div>

      <div class="cta-group">
        <button type="button" class="cta primary" id="signupTrigger">Sign up for free trial</button>
      </div>
    </section>

    <section class="panel right-panel">
      <h2 class="card-title">Sign in</h2>
      <p class="card-subtitle">Access live proximity intelligence</p>

      {% if error %}
        <div class="alert error">{{ error }}</div>
      {% endif %}

      <form id="loginForm" method="post" action="/login">
        <label for="username">Username</label>
        <input id="username" name="username" type="text" value="{{ username }}" autocomplete="username" required>

        <label for="password">Password</label>
        <input id="password" name="password" type="password" autocomplete="current-password" required>

        <div class="checkbox-row">
          <input id="terms" name="terms" type="checkbox" required>
          <label for="terms">I have read and accept the <a id="termsLink" href="#">terms and conditions</a>.</label>
        </div>

        <button class="primary-btn" type="submit">Sign in</button>
      </form>

      <div class="footer">
        <a href="/forgot-password">Forgot your password?</a>
      </div>
      <div class="footer">
        Need help? <a href="mailto:useradmin@geoprox.co.uk">Contact your GeoProx administrator</a>.
      </div>
    </section>
  </div>

  <div class="modal-overlay" id="signupModal">
    <div class="modal">
      <h2>Start your free trial</h2>
      <p>Tell us a little about you and your organisation. We will create a Free Trial account with 10 searches per month.</p>
      <form method="post" action="/signup/free-trial" id="signupForm">
        <div class="dual-column">
          <div>
            <label for="signup_full_name">Name</label>
            <input id="signup_full_name" name="full_name" type="text" value="{{ signup_data.get('full_name', '') }}" required>
          </div>
          <div>
            <label for="signup_email">Email</label>
            <input id="signup_email" name="email" type="email" value="" autocomplete="off" required>
          </div>
        </div>
        <div class="dual-column">
          <div>
            <label for="signup_phone">Phone</label>
            <input id="signup_phone" name="phone" type="tel" value="{{ signup_data.get('phone', '') }}">
          </div>
          <div>
            <label for="signup_company">Company name</label>
            <input id="signup_company" name="company_name" type="text" value="{{ signup_data.get('company_name', '') }}" required>
          </div>
        </div>
        <div>
          <label for="signup_company_number">Company number</label>
          <input id="signup_company_number" name="company_number" type="text" value="{{ signup_data.get('company_number', '') }}">
        </div>
        <div class="dual-column">
          <div>
            <label for="signup_password">Password</label>
            <input id="signup_password" name="password" type="password" minlength="8" value="" autocomplete="new-password" required>
          </div>
          <div>
            <label for="signup_confirm">Confirm password</label>
            <input id="signup_confirm" name="confirm_password" type="password" minlength="8" value="" autocomplete="new-password" required>
          </div>
        </div>
        <div class="actions">
          <button type="button" class="close-btn" data-modal-close="signupModal">Cancel</button>
          <button type="submit" class="submit-btn">Create free trial</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal-overlay" id="upgradeModal">
    <div class="modal">
      <h2>Request a full licence</h2>
      <p>Select the tier you are interested in and our team will be in touch to get you set up.</p>
      <form method="post" action="/request-upgrade" id="upgradeForm">
        <div class="dual-column">
          <div>
            <label for="upgrade_name">Name</label>
            <input id="upgrade_name" name="contact_name" type="text" value="{{ upgrade_data.get('contact_name', '') }}" required>
          </div>
          <div>
            <label for="upgrade_email">Email</label>
            <input id="upgrade_email" name="contact_email" type="email" value="{{ upgrade_data.get('contact_email', '') }}" required>
          </div>
        </div>
        <div class="dual-column">
          <div>
            <label for="upgrade_company">Company</label>
            <input id="upgrade_company" name="company" type="text" value="{{ upgrade_data.get('company', '') }}">
          </div>
          <div>
            <label for="upgrade_current">Current tier</label>
            <input id="upgrade_current" name="current_tier" type="text" value="{{ upgrade_data.get('current_tier', 'Free Trial') }}">
          </div>
        </div>
        <label for="upgrade_desired">Preferred tier</label>
        <select id="upgrade_desired" name="desired_tier" required>
          <option value="">Select a tier</option>
          {% for key, label in upgrade_options %}
            <option value="{{ key }}" {% if upgrade_data.desired_tier|default('') == key %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
        <label for="upgrade_notes">Additional information</label>
        <textarea id="upgrade_notes" name="notes" placeholder="Tell us about your use case">{{ upgrade_data.get('notes', '') }}</textarea>
        <div class="actions">
          <button type="button" class="close-btn" data-modal-close="upgradeModal">Cancel</button>
          <button type="submit" class="submit-btn">Send enquiry</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal-overlay" id="termsModal">
    <div class="modal">
      <h2>GeoProx - Terms and Conditions of Use</h2>
      <p><strong>1. Service Description</strong><br>
      GeoProx is an online portal designed to assist utilities contractors, civils contractors, and streetworks teams in completing desktop risk assessments. The tool connects in real time to publicly available records and scans a defined geographic radius each time a search is completed.</p>
      <p><strong>2. Accuracy of Results</strong><br>
      While GeoProx uses live data feeds and best-available records, the results it produces depend on third-party and public datasets. GeoProx cannot guarantee that all sites of interest will be identified, and it is possible that unofficial, unregistered, or otherwise incomplete records may not appear in search results.</p>
      <p><strong>3. User Responsibility</strong><br>
      The outputs generated by GeoProx (including but not limited to reports, maps, classifications, and risk bands) are provided for informational purposes only. It remains the responsibility of the user to verify the results and to ensure compliance with all applicable laws, permits, and safety requirements.</p>
      <p><strong>4. Limitation of Liability</strong><br>
      GeoProx, Glidepath Solutions Ltd, and its affiliates accept no liability for any inaccuracies, omissions, or errors in the results; any consequences arising from reliance on outputs generated by GeoProx; or any delays, project costs, damages, or losses (direct, indirect, or consequential) resulting from the use of the tool.</p>
      <p><strong>5. Indemnity</strong><br>
      By using GeoProx, you agree to indemnify and hold harmless GeoProx, Glidepath Solutions Ltd, and their employees, officers, and affiliates from any claims, liabilities, damages, or expenses arising from your use of the tool or reliance on its outputs.</p>
      <p><strong>6. Beta Testing / Free Trial Clause</strong><br>
      If you are using GeoProx under a free trial, pilot programme, or beta test: the service is provided strictly "as is" and "as available." No warranties, express or implied, are made regarding accuracy, reliability, or fitness for purpose. Glidepath Solutions Ltd reserves the right to modify, suspend, or terminate access to the service at any time without notice. All limitations of liability and indemnities in these Terms apply equally during trial use.</p>
      <p><strong>7. Acceptance</strong><br>
      By accessing or using GeoProx, you acknowledge that you have read, understood, and agreed to these Terms and Conditions.</p>
      <div class="actions">
        <button id="closeTerms" class="submit-btn" type="button">Close</button>
      </div>
    </div>
  </div>

  <script>
    const body = document.body;
    const signupModal = document.getElementById('signupModal');
    const upgradeModal = document.getElementById('upgradeModal');
    const termsModal = document.getElementById('termsModal');

    const modals = {
      signup: signupModal,
      upgrade: upgradeModal,
      terms: termsModal,
    };

    function openModal(modal) {
      if (modal) {
        modal.classList.add('open');
      }
    }

    function closeModal(modal) {
      if (modal) {
        modal.classList.remove('open');
      }
    }

    document.getElementById('signupTrigger')?.addEventListener('click', () => openModal(signupModal));

    document.querySelectorAll('[data-modal-close]').forEach((btn) => {
      btn.addEventListener('click', (event) => {
        const modalId = event.currentTarget.getAttribute('data-modal-close');
        closeModal(modals[modalId]);
      });
    });

    [signupModal, upgradeModal, termsModal].forEach((overlay) => {
      overlay?.addEventListener('click', (event) => {
        if (event.target === overlay) {
          closeModal(overlay);
        }
      });
    });

    const termsLink = document.getElementById('termsLink');
    const closeTerms = document.getElementById('closeTerms');
    termsLink?.addEventListener('click', (event) => {
      event.preventDefault();
      openModal(termsModal);
    });
    closeTerms?.addEventListener('click', () => closeModal(termsModal));

    const openModalName = body.dataset.openModal;
    if (openModalName && modals[openModalName]) {
      openModal(modals[openModalName]);
    }

    const form = document.getElementById('loginForm');
    const termsCheckbox = document.getElementById('terms');
    form?.addEventListener('submit', (event) => {
      if (!termsCheckbox?.checked) {
        event.preventDefault();
        alert('You must accept the terms and conditions before signing in.');
      }
    });
  </script>
</body>
</html>
