version: 1.0
runtime: python3
build:
  commands:
    build:
      - pip install -r requirements.txt
run:
  command: python -m uvicorn geoprox.main:app --host 0.0.0.0 --port 8000
  network:
    port: 8000
  environment:
    variables:
      APP_ENV: production
      GEOPROX_BUCKET: geoprox-artifacts-uk
      GEOPROX_SUPPORT_EMAIL: useradmin@geoprox.co.uk
      SMTP_HOST: smtp.office365.com
      SMTP_PORT: "587"
      SMTP_USERNAME: useradmin@geoprox.co.uk
      SMTP_USE_TLS: "true"
  secrets:
    SMTP_PASSWORD: arn:aws:secretsmanager:eu-west-1:342597974606:secret:apprunner_MVP2-HGPnrg:SMTP_PASSWORD::
    WHAT3WORDS_API_KEY: arn:aws:secretsmanager:eu-west-1:342597974606:secret:apprunner_MVP2-HGPnrg:WHAT3WORDS_API_KEY::
    DB_HOST: arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_HOST::
    DB_NAME: arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_NAME::
    DB_USER: arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_USER::
    DB_PASSWORD: arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_PASSWORD::
    DB_PORT: arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_PORT::
