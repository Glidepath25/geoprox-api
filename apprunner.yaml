version: 1.0
runtime: python3
build:
  commands:
    build:
    - pip install -r requirements.txt
run:
  command: python -m uvicorn geoprox.main:app --host 0.0.0.0 --port 8000
  network:
    port: 8000
  env:
  - name: BOOTSTRAP_ADMIN_USERNAME
    value: ADMIN
  - name: BOOTSTRAP_ADMIN_PASSWORD
    value: GeoProx25!
  - name: BOOTSTRAP_ADMIN_EMAIL
    value: admin@geoprox.co.uk
  - name: BOOTSTRAP_ADMIN_NAME
    value: GeoProx Admin
  - name: BOOTSTRAP_ADMIN_COMPANY
    value: GeoProx
  - name: APP_ENV
    value: production
  - name: GEOPROX_BUCKET
    value: geoprox-artifacts-uk
  - name: GEOPROX_SUPPORT_EMAIL
    value: useradmin@geoprox.co.uk
  - name: SMTP_HOST
    value: smtp.office365.com
  - name: SMTP_PORT
    value: '587'
  - name: SMTP_USERNAME
    value: useradmin@geoprox.co.uk
  - name: SMTP_USE_TLS
    value: 'true'
  secrets:
  - name: SMTP_PASSWORD
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:apprunner_MVP2-HGPnrg:SMTP_PASSWORD::'
  - name: WHAT3WORDS_API_KEY
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:apprunner_MVP2-HGPnrg:WHAT3WORDS_API_KEY::'
  - name: DB_HOST
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_HOST::'
  - name: DB_NAME
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_NAME::'
  - name: DB_USER
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_USER::'
  - name: DB_PASSWORD
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_PASSWORD::'
  - name: DB_PORT
    value-from: 'arn:aws:secretsmanager:eu-west-1:342597974606:secret:geoprox/app-db-shZWbT:DB_PORT::'

